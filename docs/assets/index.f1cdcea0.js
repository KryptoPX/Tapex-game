var N=Object.defineProperty;var b=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var d=(t,e,r)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,w=(t,e)=>{for(var r in e||(e={}))A.call(e,r)&&d(t,r,e[r]);if(b)for(var r of b(e))B.call(e,r)&&d(t,r,e[r]);return t};var u=(t,e,r)=>(d(t,typeof e!="symbol"?e+"":e,r),r);import{R as o,r as f,a as H}from"./vendor.4eecadcc.js";const P=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerpolicy&&(n.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?n.credentials="include":l.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(l){if(l.ep)return;l.ep=!0;const n=r(l);fetch(l.href,n)}};P();class G{constructor(){u(this,"height",9);u(this,"width",5)}}var g;(function(t){t[t.inGame=0]="inGame",t[t.Paused=1]="Paused",t[t.History=2]="History"})(g||(g={}));class E{constructor(){u(this,"Max",6);u(this,"TableSize",new G)}}u(E,"DevMode",!0),u(E,"GameMode",0);class x{constructor(e,r){u(this,"Type");u(this,"value");u(this,"iluminate",!1);this.Type=e,this.value=r}}var h;(function(t){t.null="null",t.block="block"})(h||(h={}));function z(t,e){return Math.floor(Math.random()*(+e+1-+t))+ +t}class p{static GenTable(){let e=new Array;for(let r=0;r<this.config.TableSize.height;r++){const s=Array();for(let l=0;l<this.config.TableSize.width;l++){const n=z(0,this.config.Max);s.push(new x(n==0?h.null:h.block,n))}e.push(s)}return e}static applyGravity(e){var r=Array();for(let s=0;s<this.config.TableSize.width;s++){let l=[];for(let n=0;n<this.config.TableSize.height;n++)e[n][s].Type!=h.null&&l.push(e[n][s]);for(;this.config.TableSize.height!=l.length;)l.unshift(new x(h.null,0));r.push(l)}return r[0].map((s,l)=>r.map(n=>n[l]))}}u(p,"config",new E);class m{constructor(e,r){u(this,"y");u(this,"x");this.y=e,this.x=r}}function k(t){let e=new Array;for(let l=0;l<t.length;l++)for(let n=0;n<t[l].length;n++){var r=T(t,new m(l,n),[]);r!=null&&e.push(r)}let s=new Array;return e.forEach(l=>{s.find(n=>JSON.stringify(n)==JSON.stringify(l))==null&&s.push(l)}),s}function O(t,e){return t.find(r=>r.x==e.x&&r.y==e.y)!=null}function T(t,e,r){if(t[e.y][e.x].Type==h.null)return;let s=[...t],l=[...r];for(let n=1;n<=4;n++){let a,i;switch(n){case 1:a=new m(e.y+1,e.x);break;case 2:a=new m(e.y-1,e.x);break;case 3:a=new m(e.y,e.x+1);break;case 4:a=new m(e.y,e.x-1);break;default:a=new m(-1,-1);break}s[a.y]!=null&&s[a.y][a.x]!=null&&(i=s[a.y][a.x],s[e.y][e.x].value==i.value&&!O(r,a)&&r.push(a))}if(r.sort((n,a)=>{let[i,c]=[n.y+n.x,a.y+a.x];return i<c?1:i>c?-1:0}),l.length!=r.length){for(let n=0;n<r.length;n++){let a=T(t,r[n],r);a!=null&&(r=a)}return r}}const L=({block:t,cords:e})=>{let r={num:t.value};return o.createElement("td",w({className:t.iluminate?"active":""},r),t.value)},R=({table:t,setTable:e,history:r,setHistory:s})=>{let[l,n]=f.exports.useState(new Array);f.exports.useEffect(()=>{e(p.applyGravity([...t]))},[]),f.exports.useEffect(()=>{if(l.length!=0){let i=[...t];[...r],l.forEach(c=>c.forEach(y=>i[y.y][y.x]=new x(h.null,0))),e(i)}},[l]),f.exports.useEffect(()=>{let i=p.applyGravity([...t]);if(!i.every((c,y)=>c.every((v,S)=>t[y][S].value==v.value))){const c=k(i);a([...i]),e(i),n(c)}},[t]);const a=i=>{let c=[...r],y=p.applyGravity(i);c.push(y),s(c)};return o.createElement("table",null,o.createElement("tbody",null,t.map((i,c)=>o.createElement("tr",{key:c},i.map((y,v)=>o.createElement(L,{key:c+"-"+v,cords:new m(c,v),block:y}))))))};const V=({block:t})=>{let e={num:t.value};return o.createElement("td",w({className:t.iluminate?"active":""},e),t.value)},F=({history:t})=>{f.exports.useState(new Array);let[e,r]=f.exports.useState(0),[s,l]=f.exports.useState(new Array);f.exports.useEffect(()=>{let a=[...t[e]];a.forEach(i=>i.forEach(c=>c.iluminate=!1)),k(a).forEach(i=>i.forEach(c=>a[c.y][c.x].iluminate=!0)),l(a)},[e]);const n=a=>{a?t.length-1>e&&r(e+1):0<e&&r(e-1)};return o.createElement(o.Fragment,null,o.createElement("table",null,o.createElement("tbody",null,s.map((a,i)=>o.createElement("tr",{key:i},a.map((c,y)=>o.createElement(V,{key:i+"-"+y,block:c})))))),o.createElement("div",{className:"HistoryBTNS"},o.createElement("button",{onClick:()=>n(!1)},"<--"),o.createElement("button",null,e),o.createElement("button",{onClick:()=>n(!0)},"-->")))};function M(){let[t,e]=f.exports.useState(p.GenTable()),[r,s]=f.exports.useState(new Array),[l,n]=f.exports.useState(!1);const a=()=>{n(!1),s(new Array),e(p.GenTable())};let i;return l?i=o.createElement(F,{history:r}):i=o.createElement(R,{table:t,setTable:e,history:r,setHistory:s}),o.createElement(o.Fragment,null,o.createElement("div",{className:"Game"},o.createElement("div",{className:"Table"},i),o.createElement("div",null,o.createElement("button",{onClick:a},"New Table"),o.createElement("button",{onClick:()=>n(!l)},"ShowHistory"))))}H.render(o.createElement(M,null),document.getElementById("root"));
